---
title: "探索的因子分析"
author: "tomokoba"
date: '2020-01-01'
categories: ["Statistics"]
tags: ["Statistics", "Analysis", "Exploratory Factor Analysis"]
---

<style>
  @import url(https://fonts.googleapis.com/earlyaccess/notosansjapanese.css);
</style>
<style>
  @import url(https://fonts.googleapis.com/css?family=Lato:400,900);
</style>



　科学において測定は重要である。心理学においては、目に見えない心の働きを研究するうえで様々な質問項目が利用されてきており、それがお家芸にもなっている。複数からなる質問項目がいったいどのような概念を表しているのかは関心の高いところであるが、探索的因子分析は項目への回答に影響した因子の存在を統計的に抽出する手法である。<br>
<br>

　Rで分析する場合には以下のコードを用いる。<br>

```{r eval= FALSE, include=TRUE,tidy=TRUE}
data <- XXX #分析したいデータを入れる

library(psych) #psychパッケージを使う

#因子数の決定
va<-data.frame(data$Q1,data$Q2,data$Q3,data$Q4,data$Q5,data$Q6,data$Q7,data$Q8,data$Q9,data$Q10,data$Q11) #因子分析にかける変数を取り出す

fa.parallel(va) #推定される最大の因子数（平行分析）
VSS(va,plot=FALSE)　#推定される最小の因子数（最小平均偏相関）


#探索的因子分析
fa.result <- fa(va, nfactors = 4, fm = "minres", rotate = "promax")　#たとえば因子数を4として、最小二乗法のプロマックス、どーん!
print(fa.result, sort = T, digit = 3, cut=0.3) #結果の表示。ソートかけて、桁数は3、0.3以下の結果はカット
```

　上のコードでは、回転法はプロマックス回転、初期解の算出には最小二乗法を用いている。<br>
　回転法（rotate=）については直交回転と斜交回転を選択できる。直交回転なら"varimax"、斜交回転なら"promax"が使えるが、その他の回転法も直交回転と斜交回転のそれぞれ用意されている。<br>
　初期解の算出（fm=）には、最小二乗法なら"minres"、最尤法なら"ml"、主因子法なら"pa"が使える。他にもあり。<br>

### 因子数の選定
　
　因子分析をするにあたってはまず因子数の選定が必要になってくる。基本的には理論的な説明が可能であることが大切だろうが、統計的な算出方法もある。有名なのはスクリープロットでかくんとなってるところを基準に見るやつ。<br>
　その他、平行分析と最小平均偏相関という手法がある（どちらもpsychoパッケージに入ってる）。数学的なことはわからないけど、平行分析は因子数として選定され得る数を大きめに出す。一方、最小平均偏相関は因子数を倹約的に推定する。そのため、因子数はだいたい最小平均偏相関の値から平行分析の値までの間で分析していって、理論的な説明や因子分析のモデル適合度を見ながら最終的な因子数を決めるのが良さそう。<br>
　
　データセットとしてpsychパッケージに入っている"epi.bfi"を使用する。このデータセットにはアイゼンク性格検査（EPI）とBig 5尺度、ベック抑うつ性尺度、特性‐状態不安の得点が231人分入っている。<br>

```{r include=TRUE, warning=FALSE, message=FALSE,tidy=TRUE}
library(psych) #psychパッケージを使う

va<-epi.bfi #因子分析にかける変数を取り出す。ここではすべての変数を使う。
```

+    平行分析

```{r include=TRUE, warning=FALSE, message=FALSE,tidy=TRUE}
fa.parallel(va) #推定される最大の因子数（平行分析）
```

+    最小平均偏相関<br>

　"The Velicer MAP achieves a minimum of 0.05 with..."のところのfactorsを見る。
　
　
```{r include=TRUE, warning=FALSE, message=FALSE,tidy=TRUE}
VSS(va,plot=FALSE)　#推定される最小の因子数（最小平均偏相関）
```


### 探索的因子分析

　因子数は３因子が良さそう。

```{r include=TRUE, warning=FALSE, message=FALSE,tidy=TRUE}
fa.result <- fa(va, nfactors = 3, fm = "minres", rotate = "promax")　#因子数を3として、最小二乗法のプロマックス、どーん!
print(fa.result, sort = T, digit = 3, cut=0.3) #結果の表示。ソートかけて、桁数は3、0.3以下の結果はカット
```

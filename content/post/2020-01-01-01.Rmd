---
title: "階層的重回帰分析"
author: "tomokoba"
date: '2020-01-01'
categories: ["Statistics"]
tags: ["Statistics", "Analysis", "Hierarchical Regression Analysis"]
---


<style>
  @import url(https://fonts.googleapis.com/earlyaccess/notosansjapanese.css);
  @import url(https://fonts.googleapis.com/css?family=Lato:400,900);
  pre {
    @charset “UTF-8”;
  }
</style>




　階層的重回帰分析は、ステップ１からステップ２へとステップごとに関心のある変数を投入していき、分散説明率が統計的に有意に増加することを検定することで、その変数の重要性を分析する手法である。<br>
　たとえば、大事な人に会うときや人前で話をするとき、誰しも不安を感じやすい（状態不安という）。そのときの不安の程度は、協調性や誠実さといったパーソナリティ特性によることが考えられるが、研究として関心があるのはこれらの交互作用効果だとする（"誠実さが高く協調性が高い人は周囲に合わせようとするため、不安を感じやすい"とか）。その場合は、ステップ１では説明変数として"協調性"と"誠実さ"を入れ、ステップ２ではさらに"協調性"と"誠実さ"の交互作用項を入れて分析する。ただし、各変数と交互作用項の相関による多重共線性の問題が考えられるので中心化処理（平均値を引く）を忘れずに行う。<br>

### 分析

　Rで分析する場合には以下のコードを用いる。<br>

``` {r eval=FALSE, include=TRUE,tidy=TRUE,options(encoding = "utf-8")}
data <- XXX     　　　　　　　 #分析したいデータを入れる
y  <- data$v1 　　　　　　　　 #応答変数: 状態不安
x1 <- data$v2 - mean(data$v2)  #説明変数(中心化): 協調性
x2 <- data$v3 - mean(data$v3)  #説明変数(中心化): 誠実さ
c1 <- data$v4 - mean(data$v4)  #共変量(中心化): 神経症傾向

#第1ステップ
step1 <- lm(y ~ x1 + x2 + c1)
summary(step1)

#第2ステップ
step2 <- lm(y ~ x1 + x2 + x1:x2 + c1)
summary(step2)

#平方和の変化量の検定
anova(step1, step2)

```

　
　今回は、データセットとしてpsychパッケージに入っている"epi.bfi"を使用する。このデータセットにはアイゼンク性格検査（EPI）とBig 5尺度、ベック抑うつ性尺度、特性‐状態不安の得点が231人分入っている。<br>
　
　実際に分析を行う際には、説明変数の数や共変量の有無は適宜調整する。


```{r include=TRUE,tidy=TRUE}
library(psych)
data <- epi.bfi 　　　　　　　　　　　　#分析したいデータを入れる
y  <- data$stateanx  　　　　　　　　　 #応答変数: 状態不安
x1 <- data$bfcon - mean(data$bfcon)     #説明変数(中心化): 協調性
x2 <- data$bfagree - mean(data$bfagree) #説明変数(中心化): 誠実さ
c1 <- data$bfneur - mean(data$bfneur)　 #共変量(中心化): 神経症傾向
```

+    第1ステップ

```{r echo=TRUE,tidy=TRUE}
step1 <- lm(y ~ x1 + x2 + c1)
summary(step1)
```

+    第2ステップ

```{r echo=TRUE,tidy=TRUE}
step2 <- lm(y ~ x1 + x2 + x1:x2 + c1)
summary(step2)
```

+    平方和の変化量の検定

```{r echo=TRUE,tidy=TRUE}
anova(step1, step2)
```

**結果の書き方の例**<br>

　状態不安得点を応答変数とした階層的重回帰分析を行った。その結果、ステップ1（*R^2^adj* = .27, *F* (3,227) = 29.47, *p* < .05）から交互作用項を含んだステップ2（*R^2^adj* = .28, *F* (4,226) = 23.40, *p* < .05）で分散説明率の有意な増加が見られた（*ΔR^2^* = .07, *ΔF* (1,226) = 4.03, *p* < .05）。誠実さ得点と協調性得点の交互作用効果が有意であった（*b\** = 0.002, *t* (226) = 2.01, *p* < .05）。誠実さ得点の主効果（*b\** = -0.06, *t* (226) = 1.72, *ns.*）は有意ではなかった。協調性得点の主効果が有意であった（*b\** = -0.08, *t* (226) = 2.10,  *p* < .05）。共変量の神経症傾向得点の主効果が有意であった（*b\** = 0.23, *t* (226) = 8.40, *p* < .05）。

### 単純傾斜分析

　交互作用効果が有意であった場合、下位検定として単純傾斜分析を行う。<br>
　コードは以下の通り。
　
　
```{r eval=FALSE, include=TRUE,tidy=TRUE}
#下位検定
## x1が+1SDの場合のx2の効果を分析
x1high <- data$v2 - (mean(data$v2) + sd(data$v2))
simpleslope1 <- lm(y ~ x1high + x2 + x1high:x2 + c1) 
summary(simpleslope1)

## x1が-1SDの場合のx2の効果を分析
x1low <- data$v2 - (mean(data$v2) - sd(data$v2))
simpleslope2 <- lm(y ~ x1low + x2 + x1low:x2 + c1)
summary(simpleslope2)

```
　

+    x1が+1SDの場合のx2の効果を分析

```{r echo=TRUE,tidy=TRUE}
x1high <- data$bfcon - (mean(data$bfcon) + sd(data$bfcon))
simpleslope1 <- lm(y ~ x1high + x2 + x1high:x2 + c1) 
summary(simpleslope1)
```

+    x1が-1SDの場合のx2の効果を分析

```{r echo=TRUE,tidy=TRUE}
x1low <- data$bfcon - (mean(data$bfcon) - sd(data$bfcon))
simpleslope2 <- lm(y ~ x1low + x2 + x1low:x2 + c1)
summary(simpleslope2)

```

**結果の書き方の例**<br>

　誠実さ得点と協調性得点の交互作用効果が有意であったため、下位検定として単純傾斜分析を行った。その結果、誠実さ得点を-1SDとした場合、協調性得点の負の効果が確認された（*b\** = -0.15, *t* (226) = 2.833, *p* < .05）。誠実さ得点を+1SDとした場合、協調性得点の有意な効果は認められなかった（*b\** = -0.02, *t* (226) = 0.40, *ns.*）。<br>
<br>
　あらら、なんだか変な結果に・・・
<br>
